<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Michael Kearney" />

<meta name="date" content="2019-10-08" />

<title>Endotherm Model Tutorial</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Endotherm Model Tutorial</h1>
<h4 class="author">Michael Kearney</h4>
<h4 class="date">2019-10-08</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>This document shows how to use the <code>endoR.R</code> function of NicheMapR to compute endotherm heat and mass balances. This function collates all the different steps in <a href="endotherm-components-tutorial.html">Endotherm Components Tutorial</a> into a single function that can be applied to vectors of data.</p>
</div>
<div id="single-calculation-example" class="section level2">
<h2>Single calculation example</h2>
<p>Here is how you run the calculation with all default values except specifying a local air temperature of 0 deg C.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(NicheMapR)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4">endo.out &lt;-<span class="st"> </span><span class="kw">endoR</span>(<span class="dt">TA =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6">treg &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(endo.out<span class="op">$</span>treg)</a>
<a class="sourceLine" id="cb1-7" title="7">morph &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(endo.out<span class="op">$</span>morph)</a>
<a class="sourceLine" id="cb1-8" title="8">enbal &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(endo.out<span class="op">$</span>enbal)</a>
<a class="sourceLine" id="cb1-9" title="9">masbal &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(endo.out<span class="op">$</span>masbal)</a>
<a class="sourceLine" id="cb1-10" title="10"></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="kw">kable</span>(treg[, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">TC</th>
<th align="right">TLUNG</th>
<th align="right">TSKIN_D</th>
<th align="right">TSKIN_V</th>
<th align="right">TFA_D</th>
<th align="right">TFA_V</th>
<th align="right">SHAPE_B</th>
<th align="right">PANT</th>
<th align="right">SKINWET</th>
<th align="right">K_FLESH</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">37</td>
<td align="right">34.067</td>
<td align="right">31.134</td>
<td align="right">31.134</td>
<td align="right">15.74158</td>
<td align="right">15.74158</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1.4</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">kable</span>(treg[, <span class="dv">11</span><span class="op">:</span><span class="dv">15</span>])</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">K_FUR</th>
<th align="right">K_FUR_D</th>
<th align="right">K_FUR_V</th>
<th align="right">K_COMPFUR</th>
<th align="right">Q10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0331547</td>
<td align="right">0.0331547</td>
<td align="right">0.0331547</td>
<td align="right">0.0331547</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">kable</span>(morph[, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">AREA</th>
<th align="right">VOLUME</th>
<th align="right">CHAR_DIM</th>
<th align="right">MASS_FAT</th>
<th align="right">FAT_THICK</th>
<th align="right">FLESH_VOL</th>
<th align="right">LENGTH</th>
<th align="right">WIDTH</th>
<th align="right">HEIGHT</th>
<th align="right">DIAM_FLESH</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.061118</td>
<td align="right">0.001</td>
<td align="right">0.0900254</td>
<td align="right">0.2</td>
<td align="right">0</td>
<td align="right">0.001</td>
<td align="right">0.2580762</td>
<td align="right">0.0860254</td>
<td align="right">0.0860254</td>
<td align="right">0.0430127</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">kable</span>(morph[, <span class="dv">11</span><span class="op">:</span><span class="dv">20</span>])</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">DIAM_FUR</th>
<th align="right">AREA_SIL</th>
<th align="right">AREA_SILN</th>
<th align="right">AREA_ASILP</th>
<th align="right">AREA_SKIN</th>
<th align="right">AREA_SKIN_EVAP</th>
<th align="right">AREA_CONV</th>
<th align="right">AREA_COND</th>
<th align="right">F_SKY</th>
<th align="right">F_GROUND</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0450127</td>
<td align="right">0.0124478</td>
<td align="right">0.0185303</td>
<td align="right">0.0063653</td>
<td align="right">0.0571562</td>
<td align="right">0.0559442</td>
<td align="right">0.061118</td>
<td align="right">0</td>
<td align="right">0.5</td>
<td align="right">0.5</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">kable</span>(enbal)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">QSOL</th>
<th align="right">QIRIN</th>
<th align="right">QMET</th>
<th align="right">QEVAP</th>
<th align="right">QIROUT</th>
<th align="right">QCONV</th>
<th align="right">QCOND</th>
<th align="right">ENB</th>
<th align="right">NTRY</th>
<th align="right">SUCCESS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">22.29466</td>
<td align="right">12.22314</td>
<td align="right">0.166232</td>
<td align="right">27.5027</td>
<td align="right">6.840436</td>
<td align="right">0</td>
<td align="right">0.0084275</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">kable</span>(masbal)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">AIR_L</th>
<th align="right">O2_L</th>
<th align="right">H2OResp_g</th>
<th align="right">H2OCut_g</th>
<th align="right">O2_mol_in</th>
<th align="right">O2_mol_out</th>
<th align="right">N2_mol_in</th>
<th align="right">N2_mol_out</th>
<th align="right">AIR_mol_in</th>
<th align="right">AIR_mol_out</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">55.76519</td>
<td align="right">2.336562</td>
<td align="right">0.2472705</td>
<td align="right">0</td>
<td align="right">0.521554</td>
<td align="right">0.4172432</td>
<td align="right">1.967217</td>
<td align="right">1.967217</td>
<td align="right">2.489518</td>
<td align="right">2.38922</td>
</tr>
</tbody>
</table>
</div>
<div id="metabolic-chamber-example" class="section level2">
<h2>Metabolic chamber example</h2>
<p>Now try a sequence of air temperatures for a specified core temperature, mass, fur/feather depth and base skin wetness, with the option to sweat at 0.25 % increments to cool down if needed. Note that the default settings make the environment a blackbody one (all surface and air temperatures the same) with low (5%) relative humidity and low wind speed (0.1 m/s), as is often the case in metabolic chamber experiments.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">library</span>(NicheMapR)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co"># environment</span></a>
<a class="sourceLine" id="cb7-3" title="3">TAs &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">1</span>)  <span class="co"># air temperature (deg C)</span></a>
<a class="sourceLine" id="cb7-4" title="4">VEL &lt;-<span class="st"> </span><span class="fl">0.002</span>  <span class="co"># wind speed (m/s)</span></a>
<a class="sourceLine" id="cb7-5" title="5">vd &lt;-<span class="st"> </span><span class="kw">WETAIR</span>(<span class="dt">rh =</span> <span class="dv">30</span>, <span class="dt">db =</span> <span class="dv">40</span>)<span class="op">$</span>vd  <span class="co"># Weather and Schoenbaechler had 16.7 mm Hg above 40 deg C = 30% RH at 40 deg C</span></a>
<a class="sourceLine" id="cb7-6" title="6">vd_sat &lt;-<span class="st"> </span><span class="kw">WETAIR</span>(<span class="dt">rh =</span> <span class="dv">100</span>, <span class="dt">db =</span> TAs)<span class="op">$</span>vd  <span class="co"># Weather and Schoenbaechler had 16.7 mm Hg above 40 deg C = 30% RH at 40 deg C</span></a>
<a class="sourceLine" id="cb7-7" title="7">exp_rh &lt;-<span class="st"> </span>vd<span class="op">/</span>vd_sat <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb7-8" title="8">exp_rh[exp_rh <span class="op">&gt;</span><span class="st"> </span><span class="dv">100</span>] &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb7-9" title="9">exp_rh[TAs <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>] &lt;-<span class="st"> </span><span class="dv">15</span></a>
<a class="sourceLine" id="cb7-10" title="10">hum &lt;-<span class="st"> </span>exp_rh  <span class="co">#rep(humidity,96)</span></a>
<a class="sourceLine" id="cb7-11" title="11"></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co"># core temperature</span></a>
<a class="sourceLine" id="cb7-13" title="13">TC &lt;-<span class="st"> </span><span class="dv">38</span>  <span class="co"># core temperature (deg C)</span></a>
<a class="sourceLine" id="cb7-14" title="14">TCMAX &lt;-<span class="st"> </span><span class="dv">43</span>  <span class="co"># maximum core temperature (deg C)</span></a>
<a class="sourceLine" id="cb7-15" title="15">RAISETC &lt;-<span class="st"> </span><span class="fl">0.25</span>  <span class="co"># increment by which TC is elevated (deg C)</span></a>
<a class="sourceLine" id="cb7-16" title="16"></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="co"># size and shape</span></a>
<a class="sourceLine" id="cb7-18" title="18">AMASS &lt;-<span class="st"> </span><span class="fl">0.0337</span>  <span class="co"># mass (kg)</span></a>
<a class="sourceLine" id="cb7-19" title="19">SHAPE_B_REF &lt;-<span class="st"> </span><span class="fl">1.1</span>  <span class="co"># start off near to a sphere (-)</span></a>
<a class="sourceLine" id="cb7-20" title="20">SHAPE_B_MAX &lt;-<span class="st"> </span><span class="dv">5</span>  <span class="co"># maximum ratio of length to width/depth</span></a>
<a class="sourceLine" id="cb7-21" title="21">UNCURL &lt;-<span class="st"> </span><span class="fl">0.1</span>  <span class="co"># allows the animal to uncurl to SHAPE_B_MAX, the value being the increment SHAPE_B is increased per iteration</span></a>
<a class="sourceLine" id="cb7-22" title="22">SHAPE &lt;-<span class="st"> </span><span class="dv">4</span>  <span class="co"># use ellipsoid geometry</span></a>
<a class="sourceLine" id="cb7-23" title="23">SAMODE &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co"># use bird surface area relations (2 is mammal, 0 is based on shape specified in GEOM)</span></a>
<a class="sourceLine" id="cb7-24" title="24"></a>
<a class="sourceLine" id="cb7-25" title="25"><span class="co"># feather properties</span></a>
<a class="sourceLine" id="cb7-26" title="26">DHAIRD &lt;-<span class="st"> </span><span class="fl">3e-05</span>  <span class="co"># hair diameter, dorsal (m)</span></a>
<a class="sourceLine" id="cb7-27" title="27">DHAIRV &lt;-<span class="st"> </span><span class="fl">3e-05</span>  <span class="co"># hair diameter, ventral (m)</span></a>
<a class="sourceLine" id="cb7-28" title="28">LHAIRD &lt;-<span class="st"> </span><span class="fl">0.0231</span>  <span class="co"># hair length, dorsal (m)</span></a>
<a class="sourceLine" id="cb7-29" title="29">LHAIRV &lt;-<span class="st"> </span><span class="fl">0.0227</span>  <span class="co"># hair length, ventral (m)</span></a>
<a class="sourceLine" id="cb7-30" title="30">ZFURD &lt;-<span class="st"> </span><span class="fl">0.0058</span>  <span class="co"># fur depth, dorsal (m)</span></a>
<a class="sourceLine" id="cb7-31" title="31">ZFURV &lt;-<span class="st"> </span><span class="fl">0.0056</span>  <span class="co"># fur depth, ventral (m)</span></a>
<a class="sourceLine" id="cb7-32" title="32">RHOD &lt;-<span class="st"> </span><span class="fl">8e+07</span>  <span class="co"># hair density, dorsal (1/m2)</span></a>
<a class="sourceLine" id="cb7-33" title="33">RHOV &lt;-<span class="st"> </span><span class="fl">8e+07</span>  <span class="co"># hair density, ventral (1/m2)</span></a>
<a class="sourceLine" id="cb7-34" title="34">REFLD &lt;-<span class="st"> </span><span class="fl">0.248</span>  <span class="co"># fur reflectivity dorsal (fractional, 0-1)</span></a>
<a class="sourceLine" id="cb7-35" title="35">REFLV &lt;-<span class="st"> </span><span class="fl">0.351</span>  <span class="co"># fur reflectivity ventral (fractional, 0-1)</span></a>
<a class="sourceLine" id="cb7-36" title="36"></a>
<a class="sourceLine" id="cb7-37" title="37"><span class="co"># physiological responses</span></a>
<a class="sourceLine" id="cb7-38" title="38">SKINW &lt;-<span class="st"> </span><span class="fl">0.5</span>  <span class="co"># base skin wetness (%)</span></a>
<a class="sourceLine" id="cb7-39" title="39">MXWET &lt;-<span class="st"> </span><span class="dv">5</span>  <span class="co"># maximum skin wetness (%)</span></a>
<a class="sourceLine" id="cb7-40" title="40">SWEAT &lt;-<span class="st"> </span><span class="fl">0.25</span>  <span class="co"># intervals by which skin wetness is increased (%)</span></a>
<a class="sourceLine" id="cb7-41" title="41">Q10s &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">length</span>(TAs))</a>
<a class="sourceLine" id="cb7-42" title="42">Q10s[TAs <span class="op">&gt;=</span><span class="st"> </span>TCMAX] &lt;-<span class="st"> </span><span class="dv">2</span>  <span class="co"># assuming Q10 effect kicks in only after air temp rises above TCMAX</span></a>
<a class="sourceLine" id="cb7-43" title="43">QBASAL &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="fl">1.461</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.669</span> <span class="op">*</span><span class="st"> </span><span class="kw">log10</span>(AMASS <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>))  <span class="co"># basal heat generation (W)</span></a>
<a class="sourceLine" id="cb7-44" title="44">DELTAR &lt;-<span class="st"> </span><span class="dv">5</span>  <span class="co"># offset between air temeprature and breath (°C)</span></a>
<a class="sourceLine" id="cb7-45" title="45">EXTREF &lt;-<span class="st"> </span><span class="dv">25</span>  <span class="co"># O2 extraction efficiency (%)</span></a>
<a class="sourceLine" id="cb7-46" title="46">PANTING &lt;-<span class="st"> </span><span class="fl">0.1</span>  <span class="co"># turns on panting, the value being the increment by which the panting multiplier is increased up to the maximum value, PANTMAX</span></a>
<a class="sourceLine" id="cb7-47" title="47">PANTMAX &lt;-<span class="st"> </span><span class="dv">15</span>  <span class="co"># maximum panting rate - multiplier on air flow through the lungs above that determined by metabolic rate</span></a>
<a class="sourceLine" id="cb7-48" title="48"></a>
<a class="sourceLine" id="cb7-49" title="49">ptm &lt;-<span class="st"> </span><span class="kw">proc.time</span>()  <span class="co"># start timing</span></a>
<a class="sourceLine" id="cb7-50" title="50">endo.out &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(TAs), <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb7-51" title="51">    <span class="kw">endoR</span>(<span class="dt">TA =</span> TAs[x], <span class="dt">VEL =</span> VEL, <span class="dt">TC =</span> TC, <span class="dt">TCMAX =</span> TCMAX, <span class="dt">RH =</span> hum[x], </a>
<a class="sourceLine" id="cb7-52" title="52">        <span class="dt">AMASS =</span> AMASS, <span class="dt">SHAPE =</span> SHAPE, <span class="dt">SHAPE_B_REF =</span> SHAPE_B_REF, </a>
<a class="sourceLine" id="cb7-53" title="53">        <span class="dt">SHAPE_B_MAX =</span> SHAPE_B_MAX, <span class="dt">SKINW =</span> SKINW, <span class="dt">SWEAT =</span> SWEAT, </a>
<a class="sourceLine" id="cb7-54" title="54">        <span class="dt">MXWET =</span> MXWET, <span class="dt">Q10 =</span> Q10s[x], <span class="dt">QBASAL =</span> QBASAL, <span class="dt">DELTAR =</span> DELTAR, </a>
<a class="sourceLine" id="cb7-55" title="55">        <span class="dt">DHAIRD =</span> DHAIRD, <span class="dt">DHAIRV =</span> DHAIRV, <span class="dt">LHAIRD =</span> LHAIRD, <span class="dt">LHAIRV =</span> LHAIRV, </a>
<a class="sourceLine" id="cb7-56" title="56">        <span class="dt">ZFURD =</span> ZFURD, <span class="dt">ZFURV =</span> ZFURV, <span class="dt">RHOD =</span> RHOD, <span class="dt">RHOV =</span> RHOV, </a>
<a class="sourceLine" id="cb7-57" title="57">        <span class="dt">REFLD =</span> REFLD, <span class="dt">RAISETC =</span> RAISETC, <span class="dt">PANTING =</span> PANTING, </a>
<a class="sourceLine" id="cb7-58" title="58">        <span class="dt">PANTMAX =</span> PANTMAX, <span class="dt">EXTREF =</span> EXTREF, <span class="dt">UNCURL =</span> UNCURL, </a>
<a class="sourceLine" id="cb7-59" title="59">        <span class="dt">SAMODE =</span> SAMODE)</a>
<a class="sourceLine" id="cb7-60" title="60">})  <span class="co"># run endoR across environments</span></a>
<a class="sourceLine" id="cb7-61" title="61"><span class="kw">proc.time</span>() <span class="op">-</span><span class="st"> </span>ptm  <span class="co"># stop timing</span></a></code></pre></div>
<pre><code>##    user  system elapsed 
##    0.14    0.03    0.77</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">endo.out1 &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>, <span class="kw">lapply</span>(endo.out, data.frame))  <span class="co"># turn results into data frame</span></a>
<a class="sourceLine" id="cb9-2" title="2">treg &lt;-<span class="st"> </span>endo.out1[, <span class="kw">grep</span>(<span class="dt">pattern =</span> <span class="st">&quot;treg&quot;</span>, <span class="kw">colnames</span>(endo.out1))]</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="kw">colnames</span>(treg) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="kw">colnames</span>(treg), <span class="dt">pattern =</span> <span class="st">&quot;treg.&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb9-4" title="4">morph &lt;-<span class="st"> </span>endo.out1[, <span class="kw">grep</span>(<span class="dt">pattern =</span> <span class="st">&quot;morph&quot;</span>, <span class="kw">colnames</span>(endo.out1))]</a>
<a class="sourceLine" id="cb9-5" title="5"><span class="kw">colnames</span>(morph) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="kw">colnames</span>(morph), <span class="dt">pattern =</span> <span class="st">&quot;morph.&quot;</span>, </a>
<a class="sourceLine" id="cb9-6" title="6">    <span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb9-7" title="7">enbal &lt;-<span class="st"> </span>endo.out1[, <span class="kw">grep</span>(<span class="dt">pattern =</span> <span class="st">&quot;enbal&quot;</span>, <span class="kw">colnames</span>(endo.out1))]</a>
<a class="sourceLine" id="cb9-8" title="8"><span class="kw">colnames</span>(enbal) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="kw">colnames</span>(enbal), <span class="dt">pattern =</span> <span class="st">&quot;enbal.&quot;</span>, </a>
<a class="sourceLine" id="cb9-9" title="9">    <span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb9-10" title="10">masbal &lt;-<span class="st"> </span>endo.out1[, <span class="kw">grep</span>(<span class="dt">pattern =</span> <span class="st">&quot;masbal&quot;</span>, <span class="kw">colnames</span>(endo.out1))]</a>
<a class="sourceLine" id="cb9-11" title="11"><span class="kw">colnames</span>(masbal) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="kw">colnames</span>(masbal), <span class="dt">pattern =</span> <span class="st">&quot;masbal.&quot;</span>, </a>
<a class="sourceLine" id="cb9-12" title="12">    <span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb9-13" title="13"></a>
<a class="sourceLine" id="cb9-14" title="14">QGEN &lt;-<span class="st"> </span>enbal<span class="op">$</span>QMET  <span class="co"># metabolic rate (W)</span></a>
<a class="sourceLine" id="cb9-15" title="15">H2O &lt;-<span class="st"> </span>masbal<span class="op">$</span>H2OResp_g <span class="op">+</span><span class="st"> </span>masbal<span class="op">$</span>H2OCut_g  <span class="co"># g/h water evaporated</span></a>
<a class="sourceLine" id="cb9-16" title="16">TFA_D &lt;-<span class="st"> </span>treg<span class="op">$</span>TFA_D  <span class="co"># dorsal fur surface temperature</span></a>
<a class="sourceLine" id="cb9-17" title="17">TFA_V &lt;-<span class="st"> </span>treg<span class="op">$</span>TFA_V  <span class="co"># ventral fur surface temperature</span></a>
<a class="sourceLine" id="cb9-18" title="18">TskinD &lt;-<span class="st"> </span>treg<span class="op">$</span>TSKIN_D  <span class="co"># dorsal skin temperature</span></a>
<a class="sourceLine" id="cb9-19" title="19">TskinV &lt;-<span class="st"> </span>treg<span class="op">$</span>TSKIN_V  <span class="co"># ventral skin temperature</span></a>
<a class="sourceLine" id="cb9-20" title="20">TCs &lt;-<span class="st"> </span>treg<span class="op">$</span>TC  <span class="co"># core temperature</span></a>
<a class="sourceLine" id="cb9-21" title="21"></a>
<a class="sourceLine" id="cb9-22" title="22"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb9-23" title="23"><span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb9-24" title="24"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="fl">1.5</span>, <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb9-25" title="25"><span class="kw">par</span>(<span class="dt">mgp =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb9-26" title="26"><span class="kw">plot</span>(QGEN <span class="op">~</span><span class="st"> </span>TAs, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;metabolic rate, W&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;air temperature, deg C&quot;</span>, </a>
<a class="sourceLine" id="cb9-27" title="27">    <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">1.2</span>))</a>
<a class="sourceLine" id="cb9-28" title="28"><span class="kw">points</span>(Weathers1976Fig1<span class="op">$</span>Tair, Weathers1976Fig1<span class="op">$</span>mlO2gh <span class="op">*</span><span class="st"> </span><span class="fl">20.1</span><span class="op">/</span><span class="dv">3600</span> <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-29" title="29"><span class="st">    </span>(AMASS <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb9-30" title="30"><span class="kw">plot</span>(H2O <span class="op">~</span><span class="st"> </span>TAs, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;water loss, g/h&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;air temperature, deg C&quot;</span>, </a>
<a class="sourceLine" id="cb9-31" title="31">    <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb9-32" title="32"><span class="kw">points</span>(Weathers1976Fig3<span class="op">$</span>Tair, Weathers1976Fig3<span class="op">$</span>mgH2Ogh <span class="op">*</span><span class="st"> </span>AMASS, </a>
<a class="sourceLine" id="cb9-33" title="33">    <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb9-34" title="34"><span class="kw">plot</span>(TFA_D <span class="op">~</span><span class="st"> </span>TAs, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;fur, skin and core temperature, deg C&quot;</span>, </a>
<a class="sourceLine" id="cb9-35" title="35">    <span class="dt">xlab =</span> <span class="st">&quot;air temperature, deg C&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">50</span>))</a>
<a class="sourceLine" id="cb9-36" title="36"><span class="kw">points</span>(TFA_V <span class="op">~</span><span class="st"> </span>TAs, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb9-37" title="37"><span class="kw">points</span>(TskinD <span class="op">~</span><span class="st"> </span>TAs, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>)</a>
<a class="sourceLine" id="cb9-38" title="38"><span class="kw">points</span>(TskinV <span class="op">~</span><span class="st"> </span>TAs, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb9-39" title="39"><span class="kw">points</span>(TCs <span class="op">~</span><span class="st"> </span>TAs, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb9-40" title="40"><span class="kw">points</span>(Weathers1976Fig2<span class="op">$</span>Tair, Weathers1976Fig2<span class="op">$</span>Tb, <span class="dt">pch =</span> <span class="dv">16</span>, </a>
<a class="sourceLine" id="cb9-41" title="41">    <span class="dt">col =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb9-42" title="42"><span class="kw">plot</span>(masbal<span class="op">$</span>AIR_L <span class="op">*</span><span class="st"> </span><span class="dv">1000</span><span class="op">/</span><span class="dv">60</span> <span class="op">~</span><span class="st"> </span>TAs, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">250</span>), <span class="dt">lty =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb9-43" title="43">    <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">50</span>), <span class="dt">main =</span> <span class="st">&quot;minute volume&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;ml / min&quot;</span>, </a>
<a class="sourceLine" id="cb9-44" title="44">    <span class="dt">xlab =</span> <span class="kw">paste</span>(<span class="st">&quot;air temperature (deg C)&quot;</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a>
<a class="sourceLine" id="cb9-45" title="45"><span class="kw">points</span>(Weathers1976Fig5<span class="op">$</span>breaths_min <span class="op">*</span><span class="st"> </span>(<span class="fl">13.2</span> <span class="op">*</span><span class="st"> </span>AMASS<span class="op">^</span><span class="fl">1.08</span>) <span class="op">*</span><span class="st"> </span>((Weathers1976Fig5<span class="op">$</span>Tair <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-46" title="46"><span class="st">    </span><span class="fl">273.15</span>)<span class="op">/</span><span class="fl">273.15</span>) <span class="op">~</span><span class="st"> </span>Weathers1976Fig5<span class="op">$</span>Tair, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>)  <span class="co"># tidal volume allometry from Lasiewski, R. C., and W. A. Calder. 1971, correcting volume according to PV = nRT equation, where V_2 = T_2 * V_1 / T_2, and T_1 is at STP, so 0 deg C</span></a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAAAxlBMVEUAAAAAACsAAFUAKysAK1UAK4AAVVUAVYAAVaorAAArACsrAFUrKwArK1UrK4ArVVUrVYArVaorgIArgKorgNRVAABVACtVAFVVKwBVK4BVVStVVVVVgIBVgNRVqtRVqv+AKwCAKyuAK1WAVSuAgFWAgNSAqoCAqtSA1P+qVQCqVSuqgCuqgFWq1ICq1P+q/9Sq//++vr7UgCvUgFXUqlXUqoDUqqrU1IDU////AAD/pQD/qlX/1ID/1Kr/1NT//6r//9T///+dvpnRAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2dC3vjuHWG6Unc2NNcmo09u2ku1iRpKzXNdoZJs1bk1uL//1MlQFIiKZA8AA+AA/B7n2dnbQsEyePXuBEAiwoAwRSxLwCAOSAoEA0EBaKBoEA0EBSIBoIC0UBQIBoICkQDQYFoICgQDQQFooGgQDQQFIgGggLRQFAgGggKRANBgWggKBANBAWigaBANBAUiAaCAtFAUCAaCApEA0GBaCAoEA0EBaKBoEA0EBSIBoIC0UBQIBoICkQDQYFoICgQDQQFooGgQDQQFIgGggLRQFAgGggKRANBgWggKBANBAWigaBANBAUiAaCAtFAUCAaCApEA0GBaCAoEA0EBaKBoEA0EBSIBoIC0UBQj7x/2lfVqSiKp9hXki4Q1CNK0NND/UUJQ12BoB6pBT3vXuov3v75S+xrSRUGQYstQorMrKCx7yAKDnbZH+Ihi+QgCvr84Uupq/gH1yzyAoKGgnrP78/F3b463L+6Z5ETEDQUCJsTEDQUCJsTYQW9afkej+6ZJYZl2PqdpBUdhuSJW4Iej9sxFCWoE1EFPR43ZCgEdQKChgKCOoEqPhQQ1InIvfjt+EkeqO86RB8MT5K4rykBIGgoqGE7GB4hWWaRE6jiQ0EN23k3OY8Jgvo6ZCILdJKCZ5EcbIK+P09XTVNZQNDgWSQHYwl6KgrTDIe5LCBo6CySg7eKf3s0dT6ns9hSEQpBnWBvg6oJjeQsIGjoLJKDV1C12ovSFO0NM23FTwjqBp+g5519G7QqNuMnBHWDrxev1svaZ7GdKWQQ1AneEpTUQxplsRVFIagFheErh4NvqHvx1zbooXmmbHoucs1CVfHbiDsENWFu4hXGL6nMH3LqitFu2Zfp2fKok5Rh4G+BoAbMneRi4msiC734tsS8tEmNC7x716cNzS/0N0DQWyaGGf0Iqqr3u2tHyUrQDGN/w/Qdnqam19GzSBSzoMXkNzSIz+K7qt20wtswDpp9ITp5f+/PL2uzSJZFP33OZiqXO0mD68tc0WlByQN0GQZoyU9Z0+0y/AVcmb450y43llmkyk0JelNKiRI0w9/AlamW0cwSD1oWCUMQwL+gczsQLP8B5QN68bcQqlBxa5Ky+yV08M3zzgZKE49f0LfH5Tkj1xLU8Fluv4aWmXneLk+Ic2AkqPH2ordBTZ/m9ovQzNyUaohShpqyi8vQUHGCTk9Xzu43US3e02HznSTz3XkTlLADwcx8+gwLUXSSbjj2DZi4OVZBz7vi/odLp315B4K5+fTZKTrzJIk60JRbSAh+sgp63j2d7l/LrotE2IFgdj59Zr+O6dvRf8n1P+VS5zKziAyedE8l4RT0/dO+FpTy/hTaWfP6fSw86qzD1kSONI02Fxb99FCCGrf/dztrVtX8TNh0CXr/elKRI02jzY2ZG+Nug9IWzpHPWuSzv9jMPR/0Yti3xxfiLMXcmLuvyE+SllNmszCZOPixQUFnb0u6oPls7UC8Z9I02qyYvyvmTlJFe8kkBJ2GMI02KxZuik9QteRDw9dJyslPDNSbWbon/hJ0VRYjWj+z+MVAUBOLtyS6DXp5FJbDeBPjNNpsINwRq6Al79Tw/qPa9H83jLMUc4FyP6xV/POLGqiffMBpe9bhXILUfzuo4seQboe5Dfr+7RfGXvzA0NQVhaAjvD3vnnlm93L+vOccZhoamvYvCIIOoT7u5sz57eP+ZB7Bcz0rZVFAIkxf++nDl7LblGU7L/KKIaiHLMbLUtP9Hc1VPE3rvfl2Iy/yot6L7HFQw0B9sr+k2VmKH65N9228yMtmuhBf3oellV/WA3qGJ0mpFqJzJWjZm+ftkkV6RBG0bT+xrv4y7i6V5C9qpg1aN0Dr5vuaLJIjTgnqIwvzwuT1lxAc9OL75COot2sIjYSwicFiQrDPzD1m0dveaXVeYaANMzlmkRr5C9rlIWg23sKFUIeZXLJIji0IqjMRNF906UKow0wuWSTHJgRV1bwcQRevBMNMPSIJqsZKSspWbVyRLuRU8e6CbnGYKY6gdVFQ/xu0KBC06NO5iqeTjaAWN8L/qDNoY0pOFe/eSaIDQVcecmi3yPBxVjNHSYbOM33P/PtdSCeWoOEjfUzH0JmWUfC/69jEEjRkFg05CBqhZRSb7QjaGiph+sjSXwlK0CsxBFULkjzMZlrgUn5G/90tluOSWkaRsbkPfyXo+/PT8P3x685q5lrBR/7lLbc0RFU8cREhqJoYrttVphf98VbxbZ5Rf30Q1IIogo5Xe6mmv3bT8z6ClCV1ITpRjlX8Jl+FKKME/byvTgEEJWTL1c2fz8W5k0QHgnIecrrbq2efxjVgviJtrOa5BqLmc1nRSSIDQVceMuyONrWXcSKuv0gbcmYSdD4btEEtiCWoiAG9CUPXZwxBubC6jcQni9Dy5mqCmt9929A8LzAwc122ZCFoHSab5P5L0OAbXXrLfW6B6YoS1MN+F4Kxrc4SnyyymL33Eab1gg72u9C2nvLdo966Q5D6s/iJ/LsT+J9IQj7TdAnaf0KsBNWjc2XAwY+ASBI06jv9GkX9T3Xq+8nRSaoFbRYm5PqeJNtfCX8V3z3ZjP1OP3UOCBqbm5jEFHTQSYr/yrTOUO8n0aybzXR5i/n784cv+gmx3ykMobiJStQqfjDMFF9QdZZggq4oQUdvMa+bpHd782hycoLeRiVuG1T/1XcvURDwTr8iiSqe+y3mgpAk6O20HAHv9Dt6N5Shimd/i7kgZFXxQbOg4d3Q6524z2YyDh9n8iIvYyfJJoPMBfVtqMWNJBU2fxSWvwzeNqjAmbceBbV7iygEVVjfAmsvnvlNcxx49dNq3gN1jk3U5xs+6Iff/g6Yh5l43zS3HtYafl1/dOKex28xj/18g51+lMI0KGe6o9xvmlvL8choqM7nmhXbI5HBbCYBw8e89MPkcv2sTvO/aW4lF0EZTngjO1cVPyBnQZ0uP/Ne/MWp9UM0R4OhPJ2kQd9SwPMNXi4hc7v6zAWtrrXyakVN7QWWTtKwbyng+QYrlyLC7XBvz+K5z8rA7FkJzUktez8dzyMRgX1LTlpBXa+dT9Bxd5T5rBzMnJba4Rn6ydJJkte35GWVnx5KUE9nZWHyvKQu+aATb92NT6hvyYwKkvNASu5tUNqJSYNR40RsgobMIjiNne5Dfdwz6i8zb7nPyoT5zBZ+jgxde+ZKdZKm3xBPzEIuxx5OGfAO1A9m3vKelQtzZ55UwRvGQXlK0NPEBiwWWQjlKErQRGbeTm7gtHDcONCsVfx5J2uODROr/fRQgs7NvBUysXF8eloIb0LNVMU3Q5+EPlLagjrmwN0GFbFxg+X5aUE0xJppHDTfNuhaO6vN9eJNF0D7KzelsrqN+TZo8TL9sdv5BLBez80K2r+CnnmX1sdtM2Tgp0tLZSHxIcU26IJ74gQ9CZxRP3kJV7o4NsJdzBttUtekcG9CzxykHsKlWIJSW0VrzsE8o97fWX1CCuHKQM+FjdJsn80iDtRm0aqTbOtR5wpiRNpDFpws6VdU6/1kXjSXbXeUYW1TroJOBqWoOHZ22Wwb1BIIamA2KMVSAhpog9KIEmkPWXCy6Kc4QfNtg8aJtIcsOJkLSrGYgghvFZ9tGxSCmljyU1obNMLbjoMRJdIesmBlMihFL8nKc2z1SZI1MSLtIQsqo9UDE2kmDOW8TggairBhW/n3RBpin0jDO1cNgoaCN2yEp+ALCZYOXzTUnIJ7KqU/QdXcOzXJMZctMtZCvWfK5mG0Z4wLCRaPtxbUx0xff4KqLTLU5OVcBA3USaJsHrZoz1KC3seFiYugvckyl4sYTJ8Z/sQD3gRtBkVPH4w7EiQoaKBhJsreTBPF261gRvlGH5sv4/YMJlNns2DCs6DVybjMMz1B1w+E8gs60m58sZNXu1x9U2r4QPit4iu13sYwLgpBJyFsHraoz3wCQgNTjp9eO0mtoVkIGm66HWHzMGoJOPvhsqHEC/YLhpmoSHqStKgPpYpfUNz+8rwAQUMROGzz5SPDo9tA+Bc0kxf+rEZY2BLxEyVoMBA2JyBoKBA2JzwKmt0Lf9aBsDnhcRw0txf+rARhc8L3k6SJRyJbBGFzghS2YZjWR9oyL6fUKSb2ErbsEzsePPfMzvFChATEa6j5w5Z9YteDZ57ZOV6IkID4DTV72LJPzHrwqryEBCRcqMNfQYqJWQ9elZeQgEBQWYlZD16Vl5CAQFBZiVkPXpWXkIBAUFmJWQ9elZeQgEBQWYlZDwbANxAUiAaCAtFAUCAaCApEA0GBaCAoEA0EBaKBoEA0EBSIBoIC0bAJet5RXrjQopdA0I5o381KS3wqirs9/VosL+P+1e4uKdhkuMmosQl6eDCuXTTy/qyul3SEep/YqQ4fKfHbx73axJR8LQfyZXQv5bG5SxIWGW4zalyCqvVhs0vDepTFL+qUtCNO+g/whZ59nZKa+PQj8mVUh6c2c/JdkrDIcKNR4xL0rb1qCn9/VanpR9TlAT1xef9KTHz+w1/Il3H+rFPY3CUJiww3GrUYgjapfUSvbvTc7ak5l0/0y3j/9NOCnjMdqww3GbUEBFWb5tKzbzfSJ0Tv1xZFkmqnvX9LzNkCf4LmEjX5gpaqh2lRs33a0xIfXiyLJHLOFngTNJuoxegkXSNHOKLZdJy/ud++i9RPR4KMVYabjFqUYabmcsljIOTs1WDJ289fyddCvwzbnMnYZLjJqLEJWv9tWQ7Uk45o9i98IWZfNq9npl4L/TJscyZjk+Emo4ZHnUA0EBSIBoIC0UBQIBoICkQDQYFoBAjKOvI9YuIBhpqnyDqcGYGNhE2AoD0sg76c3BxpNYDcvR43B3IO2xYFVdN5r09bMiDnsEUV9FSoKqOO19vPvmufONzt2+cO591vH4uHulJ5qM6f/6SrluYDnVYfqZO3Uxf0T0dPLOpE//Spy0/VTz/Zveif8z4MCs6mwhZT0HZhgorTow6B/ts+1+Eo71/Pu/vX9+f71/ov9rxTQXxqP1Bpr0d2c2vUT9sE/ezLu337U/1d0UR67p0b8tlW2GJX8c1srK7e6M3kUgFq/1P/q8qH9oMubTuPq4v0x5uJsSqg18le+rvnHARVbCdsUQVVvcKmKGhbRTps9Q+Lu5tIn+5/aD7QaS9HXiJ9PbLLvWwj3fy0bJbpqA9Sr+I3FbaYguoJ159uIt18bS4KujSXIweRHjb+e0VB911TFDT/a79Jj22FLaageq3rsCioI6jiWn8/iLRuC7UfqLTdkSrgqpHULFhoE3TZ9xpT9U97jSk93VxlGue217KtsMUU9Lwril/tXnqRrn/y0nZKB5H+jX5ZW/NBE1N9pE5eFsU3zbqXNkG72FVXaN803VG9/uFRd041TT84UbYVttidJAptG4jM2+8mPmBdTiSePMKWo6B/NcWz2z9jO+QRthwFNVP2u6pbII+wTQralOu9hg4AEZgUtJkVcLh/zWBYG6TLTBV/aB75PiY6XAiyIIU2KNgwEBSIZlrQ8664/wEdJBCXmU7SU909KtFDAlGZG2Y6NTtMAhCPhRL0gBIURGW2Dapf0QDS4O1x4onk//3n8kDh5MHRQS8+F6Yc03OXXA+ODwTNnSwFbTfSLQrm3TABJ2+Pd//+XfHj79/qf75ox+rf2+//WBT/ombBKy1PxYf/3jW/xb8+FnftfLqDmiXaeFsfWvz4P6ru4OaQL8OMq/6xwZkuQUv9LP4p3KUAS/SyoaL40WP7TFo7pnm4EbTZ0rb5bZ5U10KXmacm+e9vBO1nXPWPDc7ybKaAFwOsUKvfX/9WFL98LbVV2rH778+Hom+bLirrD7+/1OPvz3f7qmwsfng9//l68FXQYcbfx2sDLM9mCngxwIrm9Ubqn9ONYyNB26KybY3WdXynbbPi4+Wmiu9lPDw2NAvDTMku3NkCFoKWA8nqOv6Hpob/0LwX9mlO0FKooEA6rUetaQuC9qvC8+7uX1WbcqEEbTMuo46GQ9B0mRO01vLh9X93zVdPqrn6++pvlzGZdh3HsA16PWSc8eDYwEDQdJkTtO16t1/d7Yc98do5XSqeuspb53I5ZJix0F48EM+soOc/FsXP/0vva/dd8eH785/7Y5m6VFX8T28c9HrISNDhsYGBoEA0ENQrba2Jxx3OLAjaNVaAE90wMu/7PTcFSlCPXPaMwQM5Z6iCoq5yAIKuhyjoXF1VbBFi2B6G4UPYrKGt6pwtCrbYSqDec/uY0FTxZBU24s1wCjpY1QlBRzDcc1ZhiyDocFXnbF1lf9bkod2z/rs+oQS1TUY6ZLSqcyt1FRG6oCf1p10a4pZV2CIIuryqc0XLN3nIgjabdPZbRlmGLYagfbZTVxFZIahdFokQpw06/GYbdRURoqDPH77opV2laXSO94riEqMEPfRmUG+nKCBCvefmVRnGhTNZhS1GCdosEGyXWUHQIRhmGhK9DbqZuooI8Z5VR1M1irL/u44t6HbqKiIWjzpVzCCoVTLSIYMqnvusifL1a/eVxeCHes0QBLVKZnHIgbDWNKtIz3DV005Q9cbhzAWl3gu/oJR5YjlFepKvfT2tqvhKPYYzVEQ5hS2eoJS34OUU6QmGdlYWnaTWUAhqlY5ySNsGRRVv0BPDTCPilaCBshDMV4OeCNsICBoLs54I24goVTx5+8WcIt1xPKp/J+ysIOiI8IK2W5iS3qKQU6RbjjUzekLQEfFKUE9nFUhTZnZfa0NngKAD0Ab1zsBICGpJFEHLLT3qHCj59SsEtSPOOOiLWpNE2KkhwUjf2He8GKr67cfFIhSCDojUBn3/1jjLgeGskbm1r1Xy2AwrQVBLYgh63r2cP+8zEfTIRZchBB0QpQ369nF/Im3GJD7Sx+M/elx1HSTp/wSdJEvQi1+B0nP0gylDhynmMs0/bFYIGAed2d1OdqTHeg7q+8vPVMd9lGQ21xX3nOG6ePKtsJagg7nKs7vb2Z81GHXxafjZSFDDA/cFP1GCDogi6HhVZ/PTxNYu3Baft37OPdGcBIL2iVOC9klUUEPxOezRT+vpr4pnzEIK8QVNbHe7xi5T9V4NBZ0sPdFJsiGOoP0NbJPa3a6zz1C9Dz6v/ZzPYuYcELRPFEEHG9iaD43THV3qv1z8XEyxlMfMSSBonzidpMEGtg1mXcNGeqnyNY5ympKsOgsE7ROxBG3bnG2X3jy7qctiqWijJFkQY7nsowi6PMyJTpIV0dqg1wn1b4+q9Tlbgi4XS8tJSEUftQid+LyZrjR/oYtA0D4CevHN0u45QenqLCaYSkEpHJcSTa2CswSC9hEhaF3NPxAEXVVBMwh6rP5RzdThPHpC0CERq/jBk82TeQndUNDIVP9or8Z4T1x+QtABkTpJSk7KW1BHgk4lOy6mWGwDLH1eMz249JWpdtdA0D6xhpkqq3XxRLtmBVvyb+bzy2zPCTj1hKBD4lTxpV0Jujy8SC1BZ082nHw8mIc8B6ud1VzYTltaa9gSczYTIdhUQam9+Mu3TioaYdZzNmyD7daSnUZrA/1OIs+oXyr+Jv28uKc+X6eiCe7isyLP8051Gq0dyQg6P/7d6Geuomk5uOFBz8WWUUuisxRtiSSoS2NqolLuJFxsYXrAh565z/O2JI6go8YUJYvlSjm4n16KzyrTabSuRBI0h83DPOlJv+eEptG6E6mKN72zi+usgfDm58Q9q91YNvj2noTaoKLwVb0rLJZy5f+S6GTaoKLwqaeNoBt4STTaoA541ZNa8RjfwZvfxg2xqviE26B+i8+KWvFs4yXRFjfi4VFnim1Q73pSK55tvCQ6kqBBs+CEd9rSBNTBjw28JHpwH/xLubITNIifOQ9+2NK/j6VHhdwz6o1v6eU4qz+C6Jnx4Ic9vftYnM/GO6N+sHFDIvPGwuiZ7+CHPeMCNJigw40b0pg3Fqj4rKiDH6TtBBJn1AQNXYJ2GzckMS0nnJ/kwY+ZFQliwraKWz/nDOVug142bkhB0IB60u+5/jNfm4VsIgo6QPy8saB6Zjj44cjoJkJW8SNEzxsLM7TUB4I2jG8i4DDT8rJjKQ+Vw+sJQVts74FP0PHruOu2//0Pj6OdRtzPykkEPSFoSzxBb5YnPtWV/IPAh8pR9JycsPxMnWAzmUVSWN+CtzaoslUbK6wXH0nP6Xs+kZ5yzmaREDe34OHtPSkLGk3P2XtWI6GUx53pC2rwM9pkkW6YSVAVH1HPxXs+bGKyiKELH3KyyIB2wFnOvLGoeqKTpDAWoLEE9ZyFJTEGloYkGTZmYgsqdrpdfD0haGW6/rCCLr8nacVZVyDAzgqCVvEFNb0nie2szsjQE4IaL395A2xv0+3csmBHip7TA/XUPVUns0gG0+UHFXQw3c4xC17k6LnqnqVMYViHk59Z9+Il6ZlQ2HwRX1Bhi2tE6Tm75GMTVbybn7wl6EHO8kQJA0tDZpZ8yAmbRya7SNaHOZypQc7OIvL0TKfi8cR0F357GzdI1HPunjPYVnUZCNoh0s5q623Q6RZoyOl2AoaZpOq59Tao0yD9xIEO52po39UZcaBerp4bb4M6+xl40dyKsxKQrOdsFZ9/G9SxC28+0vmQuCWobD2TGPzwhruf+bRBhespvm/pE8cx+sljmQ4Jubud9OKzgqBDSENME8cyHRJwd7sE9NyyoFPTQMML+vZxX5VtWyrY5mEyh+VvgaAdRws/mTtJakCvDLr9YiJ2VhsWdJWfHoeZQuxul46e/gUVO110dFl2fjLPZhoMM3nf3S4lPYOUoCLnNK8rQAMPM3FODU9Lz2CDH9IkXemnx168slVF2U8bNDU9gw5+SFohMiHo4p5MU8fzHaIirKLtRdD0/CTeM2vfUoCkE0NMazJgOqSJ9OnDFw+CJqhnFEH1MXElNY/Rr8uA55A20ifjViOrQpaknlYVj/4/4+BHvCp//Sn9VvGV6suzvvAnlWH5W6j37HHwI7ykkgVt5jZVl0dLK8+qSdbOatXvinPwI2hRGufhhPmQAFtkpKynVcvo5HuOTShJjS3Q1Vm4H6JXfx0m30O16qyJ62kjqJ7AXBrCyCpViIapuQ+/Mgv3Q3zOqE9dTwtBmykNwXZO9yjp1DSmdXm4H+JvRn36esoVVGfsR1JpgjaPOikLbCzPmoOfVEGfP3zRLaXgW/vzV/lTE+lXZ8J/yKosstCTfs91b/NuH3Frfz5JjdlE7ST5yCITPdOaD8oiKUMX3pyL+yHsW2SkOyx/S0qC6pOttZShC2/Mxf0Q7i0yctIzPUGbM7pLytFDMmbjfgjrFhl52VklKqg+q1vvSaCgjNu0ZadnwoJezm4lKUsXfiIf10P4tsjIT88MBNVXQJXUVH7G7yQxZZGjnpkIqjBLOnRvYh69vZ8CBc1Tz4wEVRRjlH29b0e1ueU6pMGZHC5u8pNyfRWfq56ZCTpmbN/w+95CudjDTOpFXitmM+Wr57YEHdp4FCPop/37t8Y1SLQsctZzw4Ku8pN5NtPL+fPeVdC89cxc0PEI0m0B2nxlnzFrG/Tt4/50nQtuswNBhuOeY/IWdCzfuAnqnK+/XrzFDgQb0DN7QedY4ac/QS0WeG/AzmrTgq4hvqBbKD0VENQJj1U8aQeCrehJj3TIndMTwOOTJMoOBJvR00fTfROEfdTJuQNBaqxoGSFsTIds4aWTzrD3LbeB5Bn1ecHadN8O3mbUz26Fg0hP433n9LTwOKPe1Mx3P2vyYJjJCY8z6s+7yXlNN9MJt4B9pBG2wiVsnH/HdnlZpU4x8RrIJ8oqIfvBq/ISohEElZOQfrCaDEpeNOd4IUI0gqByErIfvCovIRpBUDkJ2Q9elZcQjSConIRWB7//m/73W1TxronXkIJOsQV9fqrOO9IGoW4XIkQjCConod3BagNbwv7KzhciRCMIKieh7cEzT48ACMPEMJPNa2gA8McWnwiDhICgQDTTgp4+fCnVGwAAiMikoOfdS7M9U8irAWDE3ITliffDAxCOuRK0vH8tUYKCqMy0QesG6NtHtEFBVNCLB6JhE/S8sxjU101b2hFvj0XxQk18KvS4A/VaLC+jbu5Y3aUrzJdPjqBF9CxOvTJqbIIeHuiPRtVLVolHqNXPJ/W6S0pi1SKpe3bkazmQL6N57bvdXTpDPAkxiuQI2kSPGDmGqHEJqlYpU7v8ZfGLOiXtiJP+A3yhZ68WAxATn35Evoyq2Qvd5i6dIZ6EGkWrCBKjR40cQ9S4BH1rr5jC319VavoRdRlAT1zevxITn//wF/JlnD/rFDZ36QzxJDZRJEeQFj1q5DiiFkPQJrUP5+pGz92emnP5ZPEb/vTTgp7zOsgnoV8+MYLU6FEjxxG1BUHrVi5tJNSjoOUHG5vbpwsE535tUQSp9ln7TokEBaVHkBQ9cuQ4oia/BC1Vz9KiPfBpT0t8eLEsyMk5r4RdUIsIku7RKnJroxajk3SNFqUvoAco+DtJ7ZRXP92vVZBPQoyiTQQp92gXubVRm3sWb5WR1VCCvlzyyBE5ezVI8vbzV/K10C/DNudV8F4+OYI290g7NUfUpkvQA3X7xYb678pyoJ50RLOH9gsx+7JZAkC9Fvpl2Oa8Ct7Lp0fQ4h6JkWOIGnXzMACigGfxQDQQFIgGVTwQzUIJatlTAoCZpSdJWPIBorIg6ClAFe/zj2BiNFfNU0x72xQ/QSsvs49Mp2yC9vZLDyeeZqkNGraKtww76TmG4afqz+68S9vQK3xBa/cyXAha2GafrF58GEGbV0Bls96KL2hNAboUtLBL0Se3AA9xcvUyuwcVsbeffdc+cbjbt88dzrvfPhYPdbXyUJ0//0lXLs0HOq0+Uidvpy3on46eWNSJ/ulTl5+qoX6y03/8Idot/vAXND19czlogeRomd6j3v9ltIsRVKQem2pDBe5cB6S8fz3v7l/fn+9f67/Z806F8an9QKW9HtnNq1E/bRP0sy/v9u1P9XdNi6bff5sAAAIASURBVCXp3Sg8Bk1PPlkO2nkXso6fqOLLULvbNbOxuuq2N4tLhaH9T0ekfGg/6NK287i6WH+8mRirQnqd7KW/e05fUIWnoKlCkhK0w+QrszzANpvJBdUvbAqDtl2kA1f/sLi7ifXp/ofmA532cuQl1tcju9zLNtbNT8tmaY76IO0q3l/QlIOUoMkQNAB6wvWnm1g3X5sLgy7N5chBrIfN/15h0H3XFAbN/+hvyxWFx6CpLylB24ygeo3rsDCoY6giW38/iLVuDbUf6DC2R6qQq2ZSs1ChTdBl32tO1T/tNaf0FHOVaZzbXofHoI3aoFNBE9EGDYLaBf9Xu5derOufvLTd0kGsf6NfGNx80ERVH6mT183lb5p1L22Cy194XU9903RI9ZqHR9091TQ94STxFbSq7f0sB01CL14Wtn+yb7+b+CBsaOPiUs6Vprr7JmgSxkFlYRvrv5o07PbN2Aougt68FcsYtC0/STLD0+gp+z38/HEK2k0RagiaWmQUkBQEBRsGggLRQFAgGggKRANBgWggKBANBAWigaBANBAUiAaCAtFAUCAaCApEA0GBaCAoEA0EBaKBoEA0EBSIBoIC0UBQIBoICkQDQYFoICgQDQQFooGgQDQQFIgGggLRQFAgGggKRANBgWggKBANBAWigaBANBAUiAaCAtFAUCCa/wdqewNCVdmMdAAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="microclimate-model-integration-example" class="section level2">
<h2>Microclimate model integration example</h2>
<p>In this final example, the microclimate model is run for a location in central Australia and the then the relevant outputs are sent into the endotherm model along with the same animal parameters as above.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">library</span>(NicheMapR)</a>
<a class="sourceLine" id="cb10-2" title="2">loc &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">131.05</span>, <span class="fl">-22.75</span>)</a>
<a class="sourceLine" id="cb10-3" title="3">Usrhyt &lt;-<span class="st"> </span><span class="fl">0.07</span></a>
<a class="sourceLine" id="cb10-4" title="4">maxshade &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb10-5" title="5">micro &lt;-<span class="st"> </span><span class="kw">micro_global</span>(<span class="dt">loc =</span> loc, <span class="dt">Usrhyt =</span> Usrhyt, <span class="dt">maxshade =</span> maxshade)</a>
<a class="sourceLine" id="cb10-6" title="6"></a>
<a class="sourceLine" id="cb10-7" title="7">metout &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(micro<span class="op">$</span>metout)</a>
<a class="sourceLine" id="cb10-8" title="8">soil &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(micro<span class="op">$</span>soil)</a>
<a class="sourceLine" id="cb10-9" title="9">shadmet &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(micro<span class="op">$</span>shadmet)</a>
<a class="sourceLine" id="cb10-10" title="10">shadsoil &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(micro<span class="op">$</span>shadsoil)</a>
<a class="sourceLine" id="cb10-11" title="11">dates &lt;-<span class="st"> </span>micro<span class="op">$</span>dates</a>
<a class="sourceLine" id="cb10-12" title="12"></a>
<a class="sourceLine" id="cb10-13" title="13">TAs &lt;-<span class="st"> </span>metout<span class="op">$</span>TALOC</a>
<a class="sourceLine" id="cb10-14" title="14">TAREFs &lt;-<span class="st"> </span>metout<span class="op">$</span>TAREF</a>
<a class="sourceLine" id="cb10-15" title="15">TSKYs &lt;-<span class="st"> </span>metout<span class="op">$</span>TSKYC</a>
<a class="sourceLine" id="cb10-16" title="16">TGRDs &lt;-<span class="st"> </span>soil<span class="op">$</span>D0cm</a>
<a class="sourceLine" id="cb10-17" title="17">VELs &lt;-<span class="st"> </span>metout<span class="op">$</span>VLOC</a>
<a class="sourceLine" id="cb10-18" title="18">RHs &lt;-<span class="st"> </span>metout<span class="op">$</span>RHLOC</a>
<a class="sourceLine" id="cb10-19" title="19">QSOLRs &lt;-<span class="st"> </span>metout<span class="op">$</span>SOLR</a>
<a class="sourceLine" id="cb10-20" title="20">Zs &lt;-<span class="st"> </span>metout<span class="op">$</span>ZEN</a>
<a class="sourceLine" id="cb10-21" title="21">ELEV &lt;-<span class="st"> </span>micro<span class="op">$</span>elev</a>
<a class="sourceLine" id="cb10-22" title="22">ABSSB &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>micro<span class="op">$</span>REFL</a>
<a class="sourceLine" id="cb10-23" title="23"></a>
<a class="sourceLine" id="cb10-24" title="24"><span class="co"># core temperature</span></a>
<a class="sourceLine" id="cb10-25" title="25">TC &lt;-<span class="st"> </span><span class="dv">38</span>  <span class="co"># core temperature (deg C)</span></a>
<a class="sourceLine" id="cb10-26" title="26">TCMAX &lt;-<span class="st"> </span><span class="dv">43</span>  <span class="co"># maximum core temperature (deg C)</span></a>
<a class="sourceLine" id="cb10-27" title="27">RAISETC &lt;-<span class="st"> </span><span class="fl">0.25</span>  <span class="co"># increment by which TC is elevated (deg C)</span></a>
<a class="sourceLine" id="cb10-28" title="28"></a>
<a class="sourceLine" id="cb10-29" title="29"><span class="co"># size and shape</span></a>
<a class="sourceLine" id="cb10-30" title="30">AMASS &lt;-<span class="st"> </span><span class="fl">0.0337</span>  <span class="co"># mass (kg)</span></a>
<a class="sourceLine" id="cb10-31" title="31">SHAPE &lt;-<span class="st"> </span><span class="dv">4</span>  <span class="co"># use ellipsoid geometry</span></a>
<a class="sourceLine" id="cb10-32" title="32">SHAPE_B_REF &lt;-<span class="st"> </span><span class="fl">1.1</span>  <span class="co"># start off near to a sphere (-)</span></a>
<a class="sourceLine" id="cb10-33" title="33">SHAPE_B_MAX &lt;-<span class="st"> </span><span class="dv">5</span>  <span class="co"># maximum ratio of length to width/depth</span></a>
<a class="sourceLine" id="cb10-34" title="34">UNCURL &lt;-<span class="st"> </span><span class="fl">0.1</span>  <span class="co"># allows the animal to uncurl to SHAPE_B_MAX, the value being the increment SHAPE_B is increased per iteration</span></a>
<a class="sourceLine" id="cb10-35" title="35"></a>
<a class="sourceLine" id="cb10-36" title="36"><span class="co"># feather properties</span></a>
<a class="sourceLine" id="cb10-37" title="37">DHAIRD =<span class="st"> </span><span class="fl">3e-05</span>  <span class="co"># hair diameter, dorsal (m)</span></a>
<a class="sourceLine" id="cb10-38" title="38">DHAIRV =<span class="st"> </span><span class="fl">3e-05</span>  <span class="co"># hair diameter, ventral (m)</span></a>
<a class="sourceLine" id="cb10-39" title="39">LHAIRD =<span class="st"> </span><span class="fl">0.0231</span>  <span class="co"># hair length, dorsal (m)</span></a>
<a class="sourceLine" id="cb10-40" title="40">LHAIRV =<span class="st"> </span><span class="fl">0.0227</span>  <span class="co"># hair length, ventral (m)</span></a>
<a class="sourceLine" id="cb10-41" title="41">ZFURD =<span class="st"> </span><span class="fl">0.0058</span>  <span class="co"># fur depth, dorsal (m)</span></a>
<a class="sourceLine" id="cb10-42" title="42">ZFURV =<span class="st"> </span><span class="fl">0.0056</span>  <span class="co"># fur depth, ventral (m)</span></a>
<a class="sourceLine" id="cb10-43" title="43">RHOD =<span class="st"> </span><span class="fl">8e+07</span>  <span class="co"># hair density, dorsal (1/m2)</span></a>
<a class="sourceLine" id="cb10-44" title="44">RHOV =<span class="st"> </span><span class="fl">8e+07</span>  <span class="co"># hair density, ventral (1/m2)</span></a>
<a class="sourceLine" id="cb10-45" title="45">REFLD =<span class="st"> </span><span class="fl">0.248</span>  <span class="co"># fur reflectivity dorsal (fractional, 0-1)</span></a>
<a class="sourceLine" id="cb10-46" title="46">REFLV =<span class="st"> </span><span class="fl">0.351</span>  <span class="co"># fur reflectivity ventral (fractional, 0-1)</span></a>
<a class="sourceLine" id="cb10-47" title="47"></a>
<a class="sourceLine" id="cb10-48" title="48"><span class="co"># physiological responses</span></a>
<a class="sourceLine" id="cb10-49" title="49">SKINW &lt;-<span class="st"> </span><span class="fl">0.1</span>  <span class="co"># base skin wetness (%)</span></a>
<a class="sourceLine" id="cb10-50" title="50">MXWET &lt;-<span class="st"> </span><span class="fl">0.1</span>  <span class="co"># maximum skin wetness (%)</span></a>
<a class="sourceLine" id="cb10-51" title="51">SWEAT &lt;-<span class="st"> </span><span class="fl">0.25</span>  <span class="co"># intervals by which skin wetness is increased (%)</span></a>
<a class="sourceLine" id="cb10-52" title="52">Q10 &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co"># Q10 effect of body temperature on metabolic rate (-)</span></a>
<a class="sourceLine" id="cb10-53" title="53">QBASAL &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="fl">1.461</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.669</span> <span class="op">*</span><span class="st"> </span><span class="kw">log10</span>(AMASS <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>))  <span class="co"># basal heat generation (W)</span></a>
<a class="sourceLine" id="cb10-54" title="54">DELTAR &lt;-<span class="st"> </span><span class="dv">5</span>  <span class="co"># offset between air temeprature and breath (°C)</span></a>
<a class="sourceLine" id="cb10-55" title="55">EXTREF &lt;-<span class="st"> </span><span class="dv">25</span>  <span class="co"># O2 extraction efficiency (%)</span></a>
<a class="sourceLine" id="cb10-56" title="56">PANTING &lt;-<span class="st"> </span><span class="fl">0.1</span>  <span class="co"># turns on panting, the value being the increment by which the panting multiplier is increased up to the maximum value, PANTMAX</span></a>
<a class="sourceLine" id="cb10-57" title="57">PANTMAX &lt;-<span class="st"> </span><span class="dv">15</span>  <span class="co"># maximum panting rate - multiplier on air flow through the lungs above that determined by metabolic rate</span></a>
<a class="sourceLine" id="cb10-58" title="58"></a>
<a class="sourceLine" id="cb10-59" title="59">ptm &lt;-<span class="st"> </span><span class="kw">proc.time</span>()  <span class="co"># start timing</span></a>
<a class="sourceLine" id="cb10-60" title="60">endo.out &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(TAs), <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb10-61" title="61">    <span class="kw">endoR</span>(<span class="dt">TA =</span> TAs[x], <span class="dt">TAREF =</span> TAREFs[x], <span class="dt">TSKY =</span> TSKYs[x], <span class="dt">TGRD =</span> TGRDs[x], </a>
<a class="sourceLine" id="cb10-62" title="62">        <span class="dt">VEL =</span> VELs[x], <span class="dt">RH =</span> RHs[x], <span class="dt">QSOLR =</span> QSOLRs[x], <span class="dt">Z =</span> Zs[x], </a>
<a class="sourceLine" id="cb10-63" title="63">        <span class="dt">ELEV =</span> ELEV, <span class="dt">ABSSB =</span> ABSSB, <span class="dt">TC =</span> TC, <span class="dt">TCMAX =</span> TCMAX, <span class="dt">AMASS =</span> AMASS, </a>
<a class="sourceLine" id="cb10-64" title="64">        <span class="dt">SHAPE =</span> SHAPE, <span class="dt">SHAPE_B_REF =</span> SHAPE_B_REF, <span class="dt">SHAPE_B_MAX =</span> SHAPE_B_MAX, </a>
<a class="sourceLine" id="cb10-65" title="65">        <span class="dt">SKINW =</span> SKINW, <span class="dt">SWEAT =</span> SWEAT, <span class="dt">Q10 =</span> Q10, <span class="dt">QBASAL =</span> QBASAL, </a>
<a class="sourceLine" id="cb10-66" title="66">        <span class="dt">DELTAR =</span> DELTAR, <span class="dt">DHAIRD =</span> DHAIRD, <span class="dt">DHAIRV =</span> DHAIRV, <span class="dt">LHAIRD =</span> LHAIRD, </a>
<a class="sourceLine" id="cb10-67" title="67">        <span class="dt">LHAIRV =</span> LHAIRV, <span class="dt">ZFURD =</span> ZFURD, <span class="dt">ZFURV =</span> ZFURV, <span class="dt">RHOD =</span> RHOD, </a>
<a class="sourceLine" id="cb10-68" title="68">        <span class="dt">RHOV =</span> RHOV, <span class="dt">REFLD =</span> REFLD, <span class="dt">RAISETC =</span> RAISETC, <span class="dt">PANTING =</span> PANTING, </a>
<a class="sourceLine" id="cb10-69" title="69">        <span class="dt">PANTMAX =</span> PANTMAX, <span class="dt">EXTREF =</span> EXTREF, <span class="dt">UNCURL =</span> UNCURL, </a>
<a class="sourceLine" id="cb10-70" title="70">        <span class="dt">SAMODE =</span> SAMODE, <span class="dt">SHADE =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb10-71" title="71">})</a>
<a class="sourceLine" id="cb10-72" title="72"><span class="kw">proc.time</span>() <span class="op">-</span><span class="st"> </span>ptm</a></code></pre></div>
<pre><code>##    user  system elapsed 
##    0.76    0.21    4.26</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">endo.out1 &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>, <span class="kw">lapply</span>(endo.out, data.frame))</a>
<a class="sourceLine" id="cb12-2" title="2"></a>
<a class="sourceLine" id="cb12-3" title="3">treg &lt;-<span class="st"> </span>endo.out1[, <span class="kw">grep</span>(<span class="dt">pattern =</span> <span class="st">&quot;treg&quot;</span>, <span class="kw">colnames</span>(endo.out1))]</a>
<a class="sourceLine" id="cb12-4" title="4"><span class="kw">colnames</span>(treg) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="kw">colnames</span>(treg), <span class="dt">pattern =</span> <span class="st">&quot;treg.&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb12-5" title="5">morph &lt;-<span class="st"> </span>endo.out1[, <span class="kw">grep</span>(<span class="dt">pattern =</span> <span class="st">&quot;morph&quot;</span>, <span class="kw">colnames</span>(endo.out1))]</a>
<a class="sourceLine" id="cb12-6" title="6"><span class="kw">colnames</span>(morph) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="kw">colnames</span>(morph), <span class="dt">pattern =</span> <span class="st">&quot;morph.&quot;</span>, </a>
<a class="sourceLine" id="cb12-7" title="7">    <span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb12-8" title="8">enbal &lt;-<span class="st"> </span>endo.out1[, <span class="kw">grep</span>(<span class="dt">pattern =</span> <span class="st">&quot;enbal&quot;</span>, <span class="kw">colnames</span>(endo.out1))]</a>
<a class="sourceLine" id="cb12-9" title="9"><span class="kw">colnames</span>(enbal) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="kw">colnames</span>(enbal), <span class="dt">pattern =</span> <span class="st">&quot;enbal.&quot;</span>, </a>
<a class="sourceLine" id="cb12-10" title="10">    <span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb12-11" title="11">masbal &lt;-<span class="st"> </span>endo.out1[, <span class="kw">grep</span>(<span class="dt">pattern =</span> <span class="st">&quot;masbal&quot;</span>, <span class="kw">colnames</span>(endo.out1))]</a>
<a class="sourceLine" id="cb12-12" title="12"><span class="kw">colnames</span>(masbal) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="kw">colnames</span>(masbal), <span class="dt">pattern =</span> <span class="st">&quot;masbal.&quot;</span>, </a>
<a class="sourceLine" id="cb12-13" title="13">    <span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb12-14" title="14"></a>
<a class="sourceLine" id="cb12-15" title="15">QGEN &lt;-<span class="st"> </span>enbal<span class="op">$</span>QMET  <span class="co"># metabolic rate (W)</span></a>
<a class="sourceLine" id="cb12-16" title="16">H2O &lt;-<span class="st"> </span>masbal<span class="op">$</span>H2OResp_g <span class="op">+</span><span class="st"> </span>masbal<span class="op">$</span>H2OCut_g  <span class="co"># g/h water evaporated</span></a>
<a class="sourceLine" id="cb12-17" title="17">TFA_D &lt;-<span class="st"> </span>treg<span class="op">$</span>TFA_D  <span class="co"># dorsal fur surface temperature</span></a>
<a class="sourceLine" id="cb12-18" title="18">TFA_V &lt;-<span class="st"> </span>treg<span class="op">$</span>TFA_V  <span class="co"># ventral fur surface temperature</span></a>
<a class="sourceLine" id="cb12-19" title="19">TskinD &lt;-<span class="st"> </span>treg<span class="op">$</span>TSKIN_D  <span class="co"># dorsal skin temperature</span></a>
<a class="sourceLine" id="cb12-20" title="20">TskinV &lt;-<span class="st"> </span>treg<span class="op">$</span>TSKIN_V  <span class="co"># ventral skin temperature</span></a>
<a class="sourceLine" id="cb12-21" title="21">TCs &lt;-<span class="st"> </span>treg<span class="op">$</span>TC  <span class="co"># core temperature</span></a>
<a class="sourceLine" id="cb12-22" title="22">SkinW &lt;-<span class="st"> </span>treg<span class="op">$</span>SKINWET  <span class="co"># skin wetness (%)</span></a>
<a class="sourceLine" id="cb12-23" title="23">Pant &lt;-<span class="st"> </span>treg<span class="op">$</span>PANT  <span class="co"># panting multiplier (-)</span></a>
<a class="sourceLine" id="cb12-24" title="24"></a>
<a class="sourceLine" id="cb12-25" title="25"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb12-26" title="26"><span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb12-27" title="27"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="fl">1.5</span>, <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb12-28" title="28"><span class="kw">par</span>(<span class="dt">mgp =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb12-29" title="29"><span class="kw">plot</span>(QGEN <span class="op">~</span><span class="st"> </span>dates, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;metabolic rate, W&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;time&quot;</span>, </a>
<a class="sourceLine" id="cb12-30" title="30">    <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, QBASAL <span class="op">*</span><span class="st"> </span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb12-31" title="31"><span class="kw">plot</span>(H2O <span class="op">~</span><span class="st"> </span>dates, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;water loss, g / h&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;time&quot;</span>, </a>
<a class="sourceLine" id="cb12-32" title="32">    <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb12-33" title="33"><span class="kw">plot</span>(TFA_D <span class="op">~</span><span class="st"> </span>dates, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;fur, skin and core temperature, deg C&quot;</span>, </a>
<a class="sourceLine" id="cb12-34" title="34">    <span class="dt">xlab =</span> <span class="st">&quot;time&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">60</span>))</a>
<a class="sourceLine" id="cb12-35" title="35"><span class="kw">points</span>(TFA_V <span class="op">~</span><span class="st"> </span>dates, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-36" title="36"><span class="kw">points</span>(TskinD <span class="op">~</span><span class="st"> </span>dates, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>)</a>
<a class="sourceLine" id="cb12-37" title="37"><span class="kw">points</span>(TskinV <span class="op">~</span><span class="st"> </span>dates, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-38" title="38"><span class="kw">points</span>(TCs <span class="op">~</span><span class="st"> </span>dates, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb12-39" title="39"><span class="kw">plot</span>((H2O<span class="op">/</span>(AMASS <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>)) <span class="op">*</span><span class="st"> </span><span class="dv">1000</span> <span class="op">~</span><span class="st"> </span>dates, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;H2O loss, % body mass / h&quot;</span>, </a>
<a class="sourceLine" id="cb12-40" title="40">    <span class="dt">xlab =</span> <span class="st">&quot;time&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">50</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
