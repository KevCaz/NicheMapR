---
title: "Introduction to the NicheMapR microclimate model"
author: "Michael Kearney"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{ectotherm model tutorial}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, echo = FALSE}
knitr::opts_chunk$set(
 eval = TRUE
)
```
This vignette provides a detailed tutorial of the Niche Mapper ectotherm model as implemented in the package *NicheMapR*. It only considers the base heat and (partial) water budget model. For details on the implementation of the Dynamic Energy Budget model (for simulating growth, development and reproduction as well as full water budgets), see the *DEB-model-tutorial* vignette (on the to do list!).

## Overview

The *NicheMapR* ectotherm model is run with the function *ectotherm*. This includes computations of steady state and transient heat budgets for animals that do not produce signficant metabolic heat. It includes a range of morphological, physiological and behavioural options to capture how organisms exchange heat and water with their environments, and to compute the consequences of this for body temperature, activity constraints and different aspects of the mass budget. It is designed to take the output of the *NicheMapR* microclimate model as the driving environmental inputs, but the user can construct custom versions of these if desired (see section xxx).

### Basic operation: modelling heat and activity budgets for the average day of each month

As with the microclimate model tutoria, this first example involves the most basic case of running the model to produce 12 days of output, one for each month of the year. Try running the model with the default inputs for a location of your choice, e.g.:

```{r}
library(NicheMapR)
```
```{r, echo=FALSE}
source('../R/ectotherm.R')
```
```{r}
micro<-micro_global(loc="Kuranda, Queensland")
ecto<-ectotherm()
```

The results are stored as a list in the variable *ecto*. The main ones to focus on for now are

* **environ** The body temperature, activity and envionments experienced by the animal
* **enbal** The components of the computed heat budget
* **masbal** The components of the computed mass budget

The output table **environ** look like this

```{r, echo=FALSE, results='asis'}
knitr::kable(head(ecto$environ[,1:13], 12), digits = 2)
knitr::kable(head(ecto$environ[,14:22], 12), digits = 2)
```

and show the body temperature and activity state, for each day of the year and for each hour of the day, as well as a series outputs relating to the environment experienced by the animal:

1. JULDAY - day of year
1. YEAR - year of simulation
1. DAY - day of simulation
1. TIME - time of day (hours)
1. TC - body temperature (deg C)
1. SHADE - shade selected (\%)
1. SOLAR  - solar radiation (W/m2) at animal location
1. DEP - depth below ground (cm)
1. ACT - activity state (0=inactive, 1=basking, 2=foraging)
1. TA - air temperature (deg C) at animal location
1. VEL - wind speed (m/s) at animal location
1. RELHUM - relative humidity (\%) at animal location
1. ZEN - zenith angle of sun (degrees - 90 = below the horizon)
1. CONDEP - depth of water body (cm) (may not be simulated or supplied)
1. WATERTEMP - temperature of water body (deg C) (may not be simulated or supplied)
1. DAYLENGTH - day length (hours)
1. WINGANGLE - wing angle (degrees) for butterfly model
1. WINGTEMP - wing temperature (degrees C) for butterfly model
1. FLYING - flying state (1=flying, 0=not flying) for butterfly model
1. FLYTIME - flying time (hours) for butterfly model
